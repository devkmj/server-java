# 🛒 이커머스 시퀀스 다이어그램

---

## 📌 주문 생성 검증
![주문 생성 시퀀스 다이어그램](/docs/images/order-sequence-diagram.png)

### 🧾 시나리오 설명
사용자가 상품을 선택하고 결제 전에 “주문 가능 여부”를 사전 검증하는 과정입니다.
잔액 조회, 상품 재고 및 상태 확인, 쿠폰 사용 가능 여부를 판단합니다.

### 🔁 주요 흐름 요약
- 사용자 인증 → 잔액 확인 → 상품 상태 및 재고 확인
- 쿠폰 사용 요청 및 만료 여부 검증
- 전체 조건이 만족되면 “주문 가능” 응답 반환

### ❗ 예외 처리
- 인증 실패 시 주문 불가
- 상품이 삭제된 경우 -> 실패 응답
- 쿠폰이 만료되거나 이미 사용된 경우 -> 실패 응답

--- 
### 📌 주문 결제
![주문 결제 시퀀스 다이어그램](/docs/images/order-pay-sequence-diagram.png)

### 🧾 시나리오 설명
사용자가 상품을 선택한 뒤 보유 잔액 및 쿠폰을 사용하여 결제하는 전체 프로세스를 보여줍니다.
트랜잭션 시작부터 잔액 차감, 재고 차감, 쿠폰 사용 처리, 주문/결제 정보 저장까지 포함됩니다.

### 🔁 주요 흐름 요약
- 사용자 인증 및 요청 수신
- 잔액 차감
- 재고 차감
- 쿠폰 사용 처리
- 주문/결제 정보 저장
- 트랜잭션 커밋 후 주문 완료 응답 반환

### ❗ 예외 처리
- 잔액 부족 시 → 주문 실패 처리
- 재고 부족 시 → 주문 실패 처리
- 쿠폰 만료 또는 이미 사용됨 → 실패 응답
- 주문/결제 정보 저장 실패 → 전체 트랜잭션 롤백

--- 

### 📌 선착순 쿠폰 발급
![선착순 쿠폰](/docs/images/coupon-sequence-diagram.png)

### 🧾 시나리오 설명
사용자가 선착순 쿠폰 이벤트에 참여하여 쿠폰을 발급받는 흐름을 나타냅니다.
쿠폰 재고 확인부터 발급 여부 판단, 저장까지의 전체 흐름을 포함합니다.

### 🔁 주요 흐름 요약
- 사용자 인증
- 해당 쿠폰 중복 발급 여부 확인
- 쿠폰 재고 수량 확인
- 쿠폰 발급 요청 및 저장
- 트랜잭션 커밋 후 발급 완료 응답 반환

### ❗ 예외 처리
- 이미 발급된 쿠폰일 경우 → 실패 응답
- 쿠폰 재고가 모두 소진된 경우 → 실패 응답
- 쿠폰 저장 실패 → 전체 트랜잭션 롤백